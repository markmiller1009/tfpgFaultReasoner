# TFPG Fault Reasoner

## Overview

The **TFPG Fault Reasoner** is a diagnostic and prognostic simulation engine designed to model, simulate, and analyze system failures using Timed Failure Propagation Graphs (TFPG). It allows engineers to define complex fault models for physical systems (such as pumps, valves, or avionics oxygen systems), inject faults via scenarios, and observe how the reasoning engine detects and isolates root causes based on sensor telemetry.

## How It Works

The system operates by loading a **Fault Model** (defining the causal relationships of the system) and a **Fault Scenario** (time-series data representing a specific test case).

1.  **Model Loading**: The engine parses a JSON-based graph where nodes represent Failure Modes (root causes) or Discrepancies (symptoms), and edges represent the propagation of failure effects over time.
2.  **Simulation**: It processes a data stream of sensor values. When signal thresholds are breached, "Discrepancy" nodes are activated.
3.  **Reasoning**: The engine traverses the graph to identify which Failure Modes could explain the observed symptoms, accounting for propagation delays defined in the model.
4.  **Prognosis**: Based on active symptoms and the graph structure, the system predicts future cascading failures (e.g., "Low Pressure" leading to "No Flow").

## Inputs

The system requires two primary JSON inputs:

### 1. Fault Model (`.json`)
Defines the system architecture.
*   **Signals**: Sensors with defined units and ranges.
*   **Nodes**:
    *   `FailureMode`: Root causes (e.g., "Pump Burnout").
    *   `Discrepancy`: Deviations from normal behavior (e.g., "Low Pressure"), containing logic gates (AND/OR), threshold predicates, and criticality levels.
*   **Edges**: Causal links with minimum and maximum time delays (`time_min_ms`, `time_max_ms`).

**Example Snippet:**
```json
{
  "from": "FM1",
  "to": "D1",
  "time_min_ms": 0,
  "time_max_ms": 20,
  "description": "Current drops almost instantly upon burnout."
}
```

### 2. Fault Scenario (`.json`)
Defines the simulation timeline.
*   **Start Time**: Simulation start.
*   **Data Stream**: A sequence of events, including:
    *   Sensor updates (`parameter_id`, `value`, `timestamp_ms`).
    *   Fault injections (setting a Failure Mode to active).
    *   Comments and expected node activations for validation.

**Example Snippet:**
```json
{
  "timestamp_ms": 1000,
  "parameter_id": "Pump_Motor_Burnout",
  "value": 1.0,
  "is_failure_mode": true
}
```

## Outputs

The system generates diagnostic reports at various time steps.

*   **Tier 1: Primary Diagnosis**: High-confidence assessments and critical prognostics (e.g., "Cascading Failure expected in 1000 ms").
*   **Tier 2: Partial Hypotheses**: Potential root causes with calculated confidence levels based on how many expected symptoms have matched.
*   **Tier 3: Unexplained Symptoms**: Observed anomalies that do not fit current hypotheses.

### Example Output
```text
[Time: 7500ms] SYSTEM DIAGNOSTIC REPORT
------------------------------------------------------------------------------
SYSTEM PROGNOSIS:
   - CRITICAL FAILURE ACTIVE (Target: D6).
   - WARNING: Cascading Failure expected in 6500 ms (Target: D4).

FAULTS DETECTED:
    1. BOS_Leak (FM4)
       > Status: VERIFIED
```

## Directory Structure

*   `FaultModels/`: Contains system definitions (e.g., `simple_pump_valve.json`, `obogs_fault_model.json`).
*   `FaultScenarios/`: Contains test cases (e.g., `valve_stuck.json`, `obogs_failure_scenario.json`).
*   `SimulatorLogs/`: Contains simulator output logs (e.g., `obogs_failure.txt`).

## Disclaimer

**AI-GENERATED CODE DISCLAIMER**

This software and documentation were generated by an Artificial Intelligence system.

1.  **No Warranty**: The software is provided "as is", without warranty of any kind, express or implied, including but not limited to the warranties of merchantability, fitness for a particular purpose, and non-infringement.
2.  **Use at Your Own Risk**: The user assumes all responsibility for determining the suitability of this code for their intended use.
3.  **Not for Critical Systems**: This code is a demonstration/simulation and has not been validated for use in safety-critical systems, avionics, or life-support applications.

---
*Generated by Gemini Code Assist*
